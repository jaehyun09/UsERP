<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.UsERP.persistence.AdDAO">

	<resultMap id="AccsMap"
		type="com.project.UsERP.vo.AccountStatementVO">
		<id property="accs_code" column="accs_code" />
		<result property="accs_type" column="accs_type" />
		<result property="accs_content" column="accs_content" />
		<result property="accs_price" column="accs_price" />
		<result property="accs_quantity" column="accs_quantity" />
		<result property="accs_reg_date" column="accs_reg_date" />
		<result property="accs_update_date" column="accs_update_date" />
		<result property="accs_sum" column="accs_sum" />
		<result property="accs_state" column="accs_state" />
		<result property="emp_code" column="emp_code" />
		<result property="pro_code" column="pro_code" />
		<result property="com_code" column="com_code" />
		<association property="employee"
			javaType="com.project.UsERP.vo.EmployeeVO">
			<id property="emp_code" column="emp_code" />
			<result property="emp_name" column="emp_name" />
		</association>
		<association property="company"
			javaType="com.project.UsERP.vo.CompanyVO">
			<id property="com_code" column="com_code" />
			<result property="com_name" column="com_name" />
		</association>
		<association property="product"
			javaType="com.project.UsERP.vo.ProductVO">
			<id property="pro_code" column="pro_code" />
			<result property="pro_name" column="pro_name" />
		</association>
	</resultMap>

	<resultMap id="SalsMap"
		type="com.project.UsERP.vo.SalaryStatementVO">
		<id property="ss_code" column="ss_code" />
		<result property="ss_total_sal" column="ss_total_sal" />
		<result property="ss_state" column="ss_state" />
		<result property="ss_sal_date" column="ss_sal_date" />
		<result property="sal_code" column="sal_code" />
		<result property="emp_code" column="emp_code" />
		<association property="employee"
			javaType="com.project.UsERP.vo.EmployeeVO">
			<id property="emp_code" column="emp_code" />
			<result property="emp_name" column="emp_name" />
		</association>
		<association property="department"
			javaType="com.project.UsERP.vo.DepartmentVO">
			<id property="dep_code" column="dep_code" />
			<result property="dep_name" column="dep_name" />
		</association>
	</resultMap>

	<!-- 강재현 : 회계보고서 - 재무상태표 -->
	<select id="get1" resultType="int">
		SELECT sum(accs_sum)
		FROM account_statement
		WHERE accs_type=1
	</select>
	<select id="get2" resultType="int">
		SELECT sum(accs_sum)
		FROM account_statement
		WHERE accs_type=2
	</select>
	<select id="get3" resultType="int">
		SELECT sum(accs_sum)
		FROM account_statement
		WHERE accs_type=3
	</select>
	<select id="get4" resultType="int">
		SELECT sum(accs_sum)
		FROM account_statement
		WHERE accs_type = 4
	</select>
	<!-- 이재홍 : 회계보고서 - 손익계산서 -->

	<!-- 이재홍 : 계좌 관리 - 계좌 리스트 -->
	<select id="bankList" resultType="com.project.UsERP.vo.BankVO">
		SELECT * FROM bank 
		ORDER BY bank_code
	</select>

	<!-- 강재현 : 계정 관리 - 계정 리스트 -->
	<select id="accountList"
		resultType="com.project.UsERP.vo.AccountVO">
		SELECT * FROM account ORDER BY acco_code
	</select>

	<!-- 강재현 : 전표 관리 - 회계 전표 -->
	<select id="statementList" resultMap="AccsMap">
		SELECT e.emp_name, a.*
			FROM employee e, account_statement a
			WHERE a.emp_code = e.emp_code
			ORDER BY accs_code
	</select>

	<!-- 강재현 : 전표 관리 - 회계 전표 상세 페이지 -->
	<select id="getStamentDetail" resultMap="AccsMap">
		SELECT e.emp_name, a.*, p.pro_name, c.com_name
			FROM employee e, account_statement a, product p, company c
			WHERE a.emp_code = e.emp_code
			AND a.pro_code = p.pro_code
			AND a.com_code = c.com_code
			AND accs_code = #{num}
			ORDER BY accs_code
	</select>

	<!-- 강재현 : 전표 관리 - 회계 전표 (승인 & 미승인) -->
	<update id="acupdatestatment"
		parameterType="com.project.UsERP.vo.AccountStatementVO">
		UPDATE account_statement SET accs_state=#{accs_state}, accs_update_date=#{accs_update_date} 
			WHERE accs_code = #{accs_code}
	</update>

	<!-- 강재현 : 전표 관리 - 급여 전표 -->
	<select id="salarystatementList" resultMap="SalsMap">
		SELECT e.emp_name, s.*
			FROM employee e, salary_statement s
			WHERE e.emp_code = s.emp_code
			ORDER BY ss_code
	</select>

	<!-- 강재현 : 전표 관리 - 급여 전표 상세 페이지 -->
	<select id="getsaStamentDetail" resultMap="SalsMap">
		SELECT s.*, e.emp_name, d.dep_name
			FROM salary_statement s,employee e, department d
			WHERE s.emp_code = e.emp_code
			AND s.dep_code = d.dep_code
	</select>
	
	<!-- 급여전표번호 사원명 부서명 총급여 지급일 -->
	
	<!-- 강재현 : 전표 관리 - 급여 전표 (승인 & 미승인) -->
	<update id="saupdatestatment"
		parameterType="com.project.UsERP.vo.SalaryStatementVO">
		UPDATE salary_statement SET ss_state=#{ss_state},
			ss_sal_date=#{ss_sal_date} WHERE ss_code = #{ss_code}
	</update>
	<!--  -->
	
	<!-- 이재홍 : 채권/채무 조회 -->
	<select id="bondDebtList" resultMap="AccsMap">
		SELECT a.*, c.com_name
			FROM account_statement a, company c
			WHERE a.com_code = c.com_code
	</select>

</mapper>