<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.project.UsERP.persistence.WaDAO">
	
	<resultMap id="commuteMap" type="com.project.UsERP.vo.CommuteVO">
      <id     property="cm_code"      column="cm_code" />  
      <result property="cm_date" 	   column="cm_date" />
      <result property="cm_start"      column="cm_start" />
      <result property="cm_end"      column="cm_end" />
      <result property="cm_night_time"      column="cm_night_time" />
      <result property="cm_over_time"      column="cm_over_time" />
      <result property="cm_address"      column="cm_address" />
      <result property="emp_code"      column="emp_code" />
	  <association property="employee" javaType="com.project.UsERP.vo.EmployeeVO">  
	  	<id     property="emp_code"   column="emp_code" />  
		<result property="emp_name"  column="emp_name" />
		<result property="emp_cos"  column="emp_cos" />
		<result property="emp_bank"  column="emp_bank" />
		<result property="emp_account"  column="emp_account" />
	 </association>  
	 </resultMap>
	 
	 <resultMap id="waMap" type="com.project.UsERP.vo.WorkRecordVO">
      <id     property="wr_code"      column="wr_code" />  
      <result property="wr_type" 	   column="wr_type" />
      <result property="wr_ap_date"      column="wr_ap_date" />
      <result property="wr_va_start"      column="wr_va_start" />
      <result property="wr_va_end"      column="wr_va_end" />
      <result property="wr_va_reason"      column="wr_va_reason" />
      <result property="wr_state"      column="wr_state" />
      <result property="emp_code"      column="emp_code" />
      <result property="dep_code"      column="dep_code" />
      <result property="hr_code"      column="hr_code" />
	  <association property="employee" javaType="com.project.UsERP.vo.EmployeeVO">  
	  	<id     property="emp_code"   column="emp_code" />  
		<result property="emp_name"  column="emp_name" />
		<result property="emp_cos"  column="emp_cos" />
		<result property="emp_bank"  column="emp_bank" />
		<result property="emp_account"  column="emp_account" />
	 </association> 
	 <association property="hrCode" javaType="com.project.UsERP.vo.HrCodeVO">  
	  	<id     property="hr_code"   column="hr_code" />  
		<result property="hr_code_name"  column="hr_code_name" />
		<result property="hr_state"  column="hr_state" />
		<result property="hcg_code"  column="hcg_code" />
	 </association> 
	 <association property="department" javaType="com.project.UsERP.vo.DepartmentVO">  
	  	<id     property="dep_code"   column="dep_code" />  
		<result property="dep_name"  column="dep_name" />
		<result property="dep_state"  column="dep_state" />
	 </association> 
	 </resultMap>
	   
	
	<!-- 김은희 - 출퇴근 조회 -->
	<select id="commuteList" resultMap="commuteMap">
		SELECT c.cm_code, c.cm_date, c.cm_start, c.cm_end, c.cm_night_time, c.cm_over_time, c.cm_address, e.emp_name, e.emp_code
		  FROM commute c , employee e
		 WHERE c.emp_code = e.emp_code
		 ORDER BY cm_code
	</select>
	
	<!-- 김은희 - 근태 조회  -->
	<select id="waList" resultMap="waMap">
		SELECT e.emp_code, e.emp_name, e.dep_code, w.wr_code, w.wr_type, w.wr_ap_date, w.wr_va_start, w.wr_va_end, w.wr_va_reason, d.dep_name
		  FROM employee e, work_record w, department d
		 WHERE e.emp_code = w.emp_code
		  AND d.dep_code = w.dep_code
		 ORDER BY wr_ap_date
	</select>
	
	<!-- 김은희 - 근태 신청 사번확인  -->
 	<select id="empComfirm" parameterType="int" resultType="int">
 		SELECT COUNT(*) FROM employee WHERE emp_code=#{emp_code}
 	</select>

</mapper>